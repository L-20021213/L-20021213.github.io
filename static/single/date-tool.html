<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>智能期限计算器</title><link rel="icon" type="image/ico" href="https://cdn.siax.cn/npm/picture-sianx@1.1.2/img/6945257127.png"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"><style>:root{--primary:#3B71CA;--secondary:#14A44D;--light:#F8F9FA;--dark:#1A2229;--border:#E0E0E0}*{box-sizing:border-box;margin:0;padding:0}body{font-family:'Segoe UI',system-ui,-apple-system;background:var(--light);color:var(--dark);line-height:1.6;padding:1rem}.container{max-width:800px;margin:2rem auto;padding:1.5rem;background:#fff;border-radius:16px;box-shadow:0 8px 30px rgba(0,0,0,.1)}.tabs{display:flex;gap:1rem;margin-bottom:2rem;flex-wrap:wrap}.tab{flex:1;padding:1rem;text-align:center;background:var(--light);border-radius:12px;cursor:pointer;transition:all .3s ease;border:2px solid transparent}.tab.active{background:var(--primary);color:#fff;transform:translateY(-2px);box-shadow:0 4px 12px rgba(59,113,202,.3)}.calculator{padding:1.5rem;background:var(--light);border-radius:12px;display:none}.calculator.active{display:block}.input-group{margin-bottom:1.5rem}.input-header{display:flex;align-items:center;gap:.5rem;margin-bottom:1rem}.input-header i{font-size:1.2rem;color:var(--primary)}.range-input{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:1rem}input[type=date],input[type=number]{width:100%;padding:.8rem;border:2px solid var(--border);border-radius:8px;font-size:1rem;transition:border-color .3s}input[type=date]:focus,input[type=number]:focus{border-color:var(--primary);outline:0}button{width:100%;padding:1rem;background:var(--primary);color:#fff;border:none;border-radius:8px;font-size:1rem;cursor:pointer;transition:all .3s;display:flex;align-items:center;justify-content:center;gap:.5rem}button:hover{background:#2c5aa3;transform:translateY(-1px);box-shadow:0 4px 12px rgba(59,113,202,.3)}.result{margin-top:2rem;padding:1.5rem;background:#fff;border:2px solid var(--primary);border-radius:12px;box-shadow:0 4px 15px rgba(59,113,202,.3);font-size:1.2rem;animation:fadeIn .5s}@keyframes fadeIn{from{opacity:0}to{opacity:1}}.date-range{color:var(--secondary);font-weight:600;margin-top:1rem;padding:1rem;background:rgba(20,164,77,.2);border-radius:8px}.copy-abbr{background:#f1f1f1;border:1px solid #ccc;border-radius:4px;padding:2px 6px;margin-left:.5rem;cursor:pointer;font-size:.9em;transition:background .2s}.copy-abbr:hover{background:#e1e1e1}.error{color:#dc4c64;padding:1rem;margin:1rem 0;background:rgba(220,76,100,.1);border-radius:8px;display:none}.holiday-item{margin:.5rem 0;padding:.5rem;background:rgba(255,193,7,.1);border-radius:4px}@media (max-width:768px){.container{margin:1rem;border-radius:12px}.tabs{flex-direction:column}.range-input{grid-template-columns:1fr}}</style></head><body><div class="container"><div class="tabs"><div class="tab active" onclick='switchTab("week")'><i class="fas fa-calendar-week"></i> 周数计算</div><div class="tab" onclick='switchTab("month")'><i class="fas fa-calendar-alt"></i> 月数计算</div></div><div id="weekCalc" class="calculator active"><div class="input-group"><div class="input-header"><i class="fas fa-calendar-day"></i><h3>基准日期</h3></div><input type="date" id="currentDateWeek"></div><div class="input-group"><div class="input-header"><i class="fas fa-sliders-h"></i><h3>周数范围</h3></div><div class="range-input"><div><input type="number" id="minWeeks" min="1" placeholder="最小周数"></div><div><input type="number" id="maxWeeks" min="1" placeholder="最大周数"></div></div></div><button onclick="calculateWeekRange()"><i class="fas fa-calculator"></i> 计算日期区间</button><div class="error" id="weekError"></div><div class="result" id="weekResult"></div></div><div id="monthCalc" class="calculator"><div class="input-group"><div class="input-header"><i class="fas fa-calendar-day"></i><h3>基准日期</h3></div><input type="date" id="currentDateMonth"></div><div class="input-group"><div class="input-header"><i class="fas fa-sliders-h"></i><h3>月数范围</h3></div><div class="range-input"><div><input type="number" id="minMonths" min="1" placeholder="最小月数"></div><div><input type="number" id="maxMonths" min="1" placeholder="最大月数"></div></div></div><button onclick="calculateMonthRange()"><i class="fas fa-calculator"></i> 计算日期区间</button><div class="error" id="monthError"></div><div class="result" id="monthResult"></div></div></div><script>function getISODate(e){return`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`}const holidayCache=new Map;function initCurrentDate(){const e=new Date,t=e=>e.toString().padStart(2,"0"),a=`${e.getFullYear()}-${t(e.getMonth()+1)}-${t(e.getDate())}`;document.getElementById("currentDateWeek").value=a,document.getElementById("currentDateMonth").value=a}function switchTab(e){document.querySelectorAll(".tab").forEach((e=>e.classList.remove("active"))),document.querySelector(`.tab[onclick="switchTab('${e}')"]`).classList.add("active"),document.querySelectorAll(".calculator").forEach((e=>e.classList.remove("active"))),document.getElementById(`${e}Calc`).classList.add("active")}async function getHolidays(e){if(holidayCache.has(e))return holidayCache.get(e);try{const t=await fetch(`https://cdn.siax.cn/gh/NateScarlet/holiday-cn@master/${e}.json`);if(!t.ok)throw new Error(`请求失败: ${t.status}`);const a=(await t.json()).days.map((e=>{const t=e.date.split("-");return{date:new Date(Date.UTC(t[0],t[1]-1,t[2])),name:e.name||"未命名节日",isOffday:void 0!==e.isOffDay?e.isOffDay:e.isOffday}})).filter((e=>!isNaN(e.date.getTime())));return holidayCache.set(e,a),a}catch(e){return console.error("节假日获取失败:",e),[]}}function copyText(e,t){navigator.clipboard.writeText(t).then((()=>{e.innerText="复制成功",setTimeout((()=>{e.innerText=t}),1e3)})).catch((()=>{e.innerText="复制失败",setTimeout((()=>{e.innerText=t}),1e3)}))}function getAbbreviation(e){return e.getFullYear().toString().slice(-2)+(e.getMonth()+1).toString().padStart(2,"0")+e.getDate().toString().padStart(2,"0")}function parseDate(e){const t=new Date(e+"T00:00:00Z");if(isNaN(t.getTime()))throw new Error("无效的日期格式");return t}function validateInput(e,t,a,n){return document.getElementById(n).style.display="none",isNaN(e.getTime())?(showError(n,"请输入有效的基准日期"),!1):t>0&&a>=t||(showError(n,"请输入有效范围（最小值 ≤ 最大值）"),!1)}function showError(e,t){const a=document.getElementById(e);a.innerHTML=`<i class="fas fa-exclamation-circle fa-fw"></i> ${t}`,a.style.display="block"}const addWeeks=(e,t)=>new Date(e.getTime()+7*t*24*3600*1e3),addMonths=(e,t)=>{const a=new Date(e);return a.setUTCMonth(a.getUTCMonth()+t),a.getUTCMonth()!==(e.getUTCMonth()+t)%12?new Date(a.getUTCFullYear(),a.getUTCMonth()+1,0):a};async function showResult(e,t,a){const n=document.getElementById(e),o={year:"numeric",month:"long",day:"numeric",weekday:"short"};n.innerHTML=`\n        <div class="date-range">\n          <div>\n            <i class="fas fa-play-circle fa-fw"></i> 起始日期：${t.toLocaleDateString("zh-CN",o)} \n            <span class="copy-abbr" onclick="copyText(this, '${getISODate(t)}')">${getISODate(t)}</span>\n            <span class="copy-abbr" onclick="copyText(this, '${getAbbreviation(t)}')">${getAbbreviation(t)}</span>\n          </div>\n          <div>\n            <i class="fas fa-flag-checkered fa-fw"></i> 截止日期：${a.toLocaleDateString("zh-CN",o)} \n            <span class="copy-abbr" onclick="copyText(this, '${getISODate(a)}')">${getISODate(a)}</span>\n            <span class="copy-abbr" onclick="copyText(this, '${getAbbreviation(a)}')">${getAbbreviation(a)}</span>\n          </div>\n          <div style="margin-top:1rem; color:var(--primary);">\n            <i class="fas fa-clock fa-fw"></i> 总天数：${Math.round((a-t)/864e5)} 天\n          </div>\n          <div style="margin-top:1rem; color:#666;" id="${e}Holidays">\n            <i class="fas fa-spinner fa-spin fa-fw"></i> 正在查询节假日...\n          </div>\n        </div>`;try{const n=new Set([t.getUTCFullYear(),a.getUTCFullYear()]),o=(await Promise.all([...n].map(getHolidays))).flat().filter((e=>e.isOffday)),r=Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()),i=Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),s=o.filter((e=>{const t=e.date.getTime();return t>=r&&t<=i})).sort(((e,t)=>e.date-t.date)),c=s.length?`\n          <div style="margin-top:1rem;">\n            <i class="fas fa-umbrella-beach fa-fw"></i> 包含法定节假日（${s.length}个）：\n            ${s.map((e=>`\n              <div class="holiday-item">\n                ${e.date.toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",weekday:"short"})}\n                <strong>${e.name}</strong>\n                <span style="color:#666;">（休息日）</span>\n              </div>\n            `)).join("")}\n          </div>`:'<div style="color:#999;margin-top:1rem;">🎉 该时间段内无法定节假日</div>';document.getElementById(`${e}Holidays`).outerHTML=c}catch(t){document.getElementById(`${e}Holidays`).outerHTML=`\n          <div style="color:#dc3545; margin-top:1rem;">\n            <i class="fas fa-exclamation-triangle fa-fw"></i> ${t.message}\n            <button onclick="window.location.reload()" style="margin-top:0.5rem; padding:0.3rem 0.8rem; background:#fff3cd; border:1px solid #ffc107;">重试</button>\n          </div>`}n.scrollIntoView({behavior:"smooth"})}async function calculateWeekRange(){try{const e=parseDate(document.getElementById("currentDateWeek").value),t=parseInt(document.getElementById("minWeeks").value),a=parseInt(document.getElementById("maxWeeks").value);if(!validateInput(e,t,a,"weekError"))return;const n=addWeeks(e,t),o=addWeeks(e,a);await showResult("weekResult",n,o)}catch(e){showError("weekError",e.message)}}async function calculateMonthRange(){try{const e=parseDate(document.getElementById("currentDateMonth").value),t=parseInt(document.getElementById("minMonths").value),a=parseInt(document.getElementById("maxMonths").value);if(!validateInput(e,t,a,"monthError"))return;const n=addMonths(e,t),o=addMonths(e,a);await showResult("monthResult",n,o)}catch(e){showError("monthError",e.message)}}document.addEventListener("DOMContentLoaded",initCurrentDate)</script></body></html>